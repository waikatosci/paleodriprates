# Holocene Precipitation Reconstruction from Stalagmite Records (applied to Stalagmite HS4 in Hartland et al.) #

## Overview

This repository contains data, code, and documentation for reconstructing annual precipitation (P) during the Holocene (~73 to ~8648 years before present, BP) in central China, based on stalagmite drip rates from Heshang Cave. The reconstruction integrates hydrological proxies (drip rates), temperature proxies (from bacterial 3-hydroxy fatty acids in stalagmites), and modern regression models to estimate past precipitation with uncertainties.

The methodology uses Monte Carlo simulations to propagate errors, drawing on a published temperature reconstruction from the same stalagmite sample (Wang et al., QSR 2018). This work aims to provide insights into Holocene hydroclimate variability, potentially linked to East Asian Monsoon dynamics.

**Key Outputs:**
- Reconstructed precipitation (median and 25th/75th percentiles) in `p_reconstruction.csv`.
- A plot of the reconstruction in `p_plot.png` (generated by the notebook).

**Significance:** This reconstruction reveals trends like wetter early-mid Holocene conditions (~1400–1500 mm/yr) transitioning to drier late Holocene (~1000–1300 mm/yr), complementing global paleoclimate records. It demonstrates a robust proxy-based approach for quantifying past rainfall, useful for climate modeling and understanding monsoon responses to orbital forcing.

## Prerequisites

- **Software:** Python 3.12+ with Jupyter Notebook support.
- **Libraries:** Install via `pip` (requirements.txt provided if needed):
  - pandas
  - numpy
  - scipy
  - matplotlib
- **Data Sources:** All files are self-contained; no external downloads required beyond the cited reference for context.

## Files and their Significance

1. **p_reconstruction.csv**
   - **Description:** CSV file containing the final reconstructed annual precipitation values.
   - **Columns:**
     - `age`: Age in years BP (e.g., 73 to 8648 BP).
     - `P_med`: Median annual precipitation (mm/yr).
     - `P_pc25`: 25th percentile (lower uncertainty bound).
     - `P_pc75`: 75th percentile (upper uncertainty bound).
   - **Significance:** This is the primary output dataset. It quantifies Holocene precipitation with uncertainties, enabling further analysis. Generated by the notebook via Monte Carlo simulation.

2. **Heshang-Yichang_PT_regression_data.xlsx**
   - **Description:** Excel file with modern calibration data (2005–2015 CE) for relating stalagmite drip rates to precipitation-temperature (P/T) ratios.
   - **Sheets:**
     - "Sheet1": Year, baseflow drip rates (drips/min) with errors, average P/T from meteorological data, and modeled P/T values.
   - **Significance:** Provides regression parameters (e.g., slopes, intercepts, residuals) for modern analogs. Used to calibrate drip rates to P/T, assuming uniformitarianism (modern relationships apply to the past). Data from Heshang Cave (see Hu et al., 2008 for monitoring information) and Yichang station; utilised in the two-stage (i.e., chained) regression in the reconstruction.

3. **P_quantification_Holocene.ipynb**
   - **Description:** Jupyter Notebook with Python code for the full reconstruction pipeline.
   - **Key Sections:**
     - Load input data.
     - Interpolate drip rates to match temperature ages.
     - Perform Monte Carlo simulations (N=10,000) to estimate P with uncertainties.
     - Output CSV and plot.
   - **Significance:** This is the computational core. It processes inputs, applies regressions, and handles error propagation. Users can run it to reproduce results or modify parameters (e.g., regression coeffs or N). Paleoclimate modeling with scipy/numpy.

4. **drip_rate_percentiles.xlsx**
   - **Description:** Excel file with Holocene drip rate percentiles from stalagmite HS4.
   - **Sheets:**
     - "HS4": High-resolution data (ages -51 to 9499 BP) with `age_calBP`, `DR_med` (median drip rate, drips/min), `DR_pc25`, and `DR_pc75`.
   - **Significance:** Core hydrological proxy dataset from Hartland et al (submitted to Nature Geoscience). Drip rates reflect cave infiltration (linked to effective precipitation). Percentiles enable lognormal modeling of uncertainties. Interpolated in the notebook to align with temperature data.

5. **Precip_from_drip_rates.xlsx**
   - **Description:** Excel file combining age-temperature data with derived P/T and precipitation.
   - **Sheets:**
     - "Sheet1": Ages BP, RAN15-MAAT temperatures (°C) from Wang et al. (2018), high-resolution P/T series, and daily precipitation.
   - **Significance:** Bridges temperature proxies (bacterial lipids) with drip rates. Temperatures (~16.5–20.5°C) show a mid-Holocene optimum. Used as input for the notebook; see Wang et al. for validation.

6. **p_plot.png** (Generated File)
   - **Description:** PNG image of precipitation reconstruction plot (age vs. P_med with error bars).
   - **Significance:** Visual summary of results. Highlights trends and uncertainties for quick interpretation.

## Step-by-Step Guide to Reproduce the P-Reconstruction

Follow these steps to run the workflow and understand the process:

1. **Set Up Environment:**
   - Install Python and required libraries: `pip install pandas numpy scipy matplotlib`.
   - Open the repository in Jupyter Notebook or VS Code.

2. **Review Input Data:**
   - Examine `drip_rate_percentiles.xlsx` for drip rate trends (e.g., decreasing over time, implying drier conditions).
   - Check `Precip_from_drip_rates.xlsx` for temperature proxy (warmer mid-Holocene).
   - Inspect `Heshang-Yichang_PT_regression_data.xlsx` for modern calibrations (P/T ~0.09–0.21).

3. **Run the Notebook (`P_quantification_Holocene.ipynb`):**
   - Execute cells sequentially.
   - **Key Steps in Code:**
     - Load data from `Precip_from_drip_rates.xlsx` and `drip_rate_percentiles.xlsx`.
     - Interpolate drip rates using `scipy.interpolate.interp1d`.
     - Define regression parameters (from modern data: Heshang and Yichang models).
     - For each age: Sample distributions (drip as lognormal, T as normal), apply regressions (drip → P/T_H → P/T_Y), compute annual P = (P/T_Y * T) * 365.25.
     - Output medians/percentiles to `p_reconstruction.csv`.
     - Generate plot and save as `p_plot.png`.
     - Runtime: ~1–2 minutes (depending on N=10,000 simulations).

4. **Analyze Outputs:**
   - Open `p_reconstruction.csv` in a spreadsheet or pandas for stats (e.g., mean P ~1100 mm/yr).
   - View `p_plot.png` for trends: Higher P in early Holocene, variability in mid-late periods.
   - Modern Yichang rainfall (~1400–1500 mm/yr) for context.

5. **Modify/Extend (Optional):**
   - Adjust regression params in the notebook for sensitivity tests.

## References

- Wang, C. et al. (2018). Holocene temperature and hydrological changes reconstructed by bacterial 3-hydroxy fatty acids in a stalagmite from central China. *Quaternary Science Reviews*, 192, 97–105. DOI: 10.1016/j.quascirev.2018.05.030.
- Data and code from Hartland et al. submitted to Nature Geoscience; contact adam.hartland@lincolnagritech.co.nz.

Last Updated: August 08, 2025